!function(n){var a={pageCount:1,init:function(n,t){return function(){a.initTable(n,t),a.doRequest(n,t),a.bindEvent(n,t)}()},initTable:function(n,t){return function(){n.empty(),n.append('<table><thead></thead><tbody></tbody></table><div class="lhpagination"></div>');var e="<tr>";for(i=0;i<t.header.length;i++)e+="<th>"+t.header[i].name+"</th>";e+="</tr>",a.perPage=t.perPage,n.find("thead").append(e)}()},doRequest:function(t,e){return function(){n.ajax({type:"GET",url:e.dataUrl,data:{page:a.current,perPage:a.perPage},dataType:e.dataType,headers:{"X-CSRF-TOKEN":e.csrfToken},success:function(n){a.fillData(t,n,e)},error:function(){console.log("Connection error")}})}()},fillData:function(n,t,e){return function(){if(0==t.ret){var r="";a.pageCount=Math.ceil(t.data.total/a.perPage),a.current=t.data.current_page,a.current=a.current||e.currentPage;var c=t.data.data;for(i=0;i<t.data.data.length;i++)r+="<tr><td>"+moment().format("YYYY-MM-D hh:mm:ss")+"</td><td>"+c[i].order_id+"</td><td>"+c[i].money+"</td><td>"+c[i].game_name+"</td><td>"+c[i].game_server_name+"</td><td>"+c[i].pay_channel_name+'</td><td><span class="success">成功</span></td><td><span class="success">成功</span></td></tr>';n.find("tbody").html(r),a.fillHtml(n)}}()},fillHtml:function(n){return function(){n.find(".lhpagination").empty(),a.current>1?n.find(".lhpagination").append('<a href="javascript:;" class="prevPage">上一页</a>'):n.find(".lhpagination").append('<span class="disabled">上一页</span>'),1!=a.current&&a.current>=4&&4!=a.pageCount&&n.find(".lhpagination").append('<a href="javascript:;" class="tcdNumber">1</a>'),a.current-2>2&&a.current<=a.pageCount&&a.pageCount>5&&n.find(".lhpagination").append("<span>...</span>");var t=a.current-2,e=a.current+2;for((t>1&&a.current<4||1==a.current)&&e++,a.current>a.pageCount-4&&a.current>=a.pageCount&&t--;t<=e;t++)t<=a.pageCount&&t>=1&&(t!=a.current?n.find(".lhpagination").append('<a href="javascript:;" class="tcdNumber">'+t+"</a>"):n.find(".lhpagination").append('<span class="current">'+t+"</span>"));a.current+2<a.pageCount-1&&a.current>=1&&a.pageCount>5&&n.find(".lhpagination").append("<span>...</span>"),a.current!=a.pageCount&&a.current<a.pageCount-2&&4!=a.pageCount&&n.find(".lhpagination").append('<a href="javascript:;" class="tcdNumber">'+a.pageCount+"</a>"),a.current<a.pageCount?n.find(".lhpagination").append('<a href="javascript:;" class="nextPage">下一页</a>'):(n.find(".lhpagination").remove(".nextPage"),n.find(".lhpagination").append('<span class="disabled">下一页</span>'))}()},bindEvent:function(t,e){return function(){t.on("click","a.tcdNumber",function(){var r=parseInt(n(this).text());a.current=r,a.doRequest(t,e),"function"==typeof e.backFn}),t.on("click","a.prevPage",function(){var n=parseInt(t.find(".lhpagination").children("span.current").text());a.current=n-1,a.doRequest(t,e),"function"==typeof e.backFn}),t.on("click","a.nextPage",function(){var n=parseInt(t.find(".lhpagination").children("span.current").text());a.current=n+1,a.doRequest(t,e),"function"==typeof e.backFn})}()}};n.fn.createPage=function(t){var e=n.extend({current:1,perPage:6,backFn:function(n){}},t);a.init(this,e)}}(jQuery);